sap.ui.define(["application/controller/BaseController","sap/ui/core/routing/History","sap/ui/model/json/JSONModel"],function(t,e,o){"use strict";return t.extend("application.controller.verbaConsultasDetalhe",{onInit:function(t){this.getRouter().getRoute("verbaConsultasDetalhe").attachPatternMatched(this._onLoadFields,this)},_onLoadFields:function(){var t=this;var e=new o({Bukrs:"",CodMotivVerba:"",DatMovto:"",HraMovto:"",IdMovtoVerba:"",IvUsuario:"",Lifnr:"",NrPedido:"",OrigemMovto:"",Periodo:"",TipoMovto:"",Usuario:"",ValMovto:"",ValSaldo:""});t.setModel(e,"modelMov");var r=this.getModelGlobal("modelVerba").getProperty("/Bukrs");var a=this.getModelGlobal("modelVerba").getProperty("/Periodo");var i=r+"."+a;this.byId("idTopLevelIconTabBar").setSelectedKey("tab1");var n=[];var l=indexedDB.open("PRED");l.onerror=function(t){alert(l.error.mensage)};l.onsuccess=function(){var e=l.result;var o=e.transaction("TabelaMovimentacao","readwrite");var r=o.objectStore("TabelaMovimentacao");var a=r.index("IndexAcesso");var n=a.getAll(i);n.onsuccess=function(e){var o=e.target.result;if(o!==undefined){var r=o;var a=[];var i=new Date;var n=i.getFullYear();var l=i.getMonth()+1;l=String(l).length==1?"0"+String(l):l;var s=i.getDate();s=String(s).length==1?"0"+String(s):s;i=n+l+s;for(var v=0;v<r.length;v++){var d=r[v];delete d._metadata;if(d.TipoMovto=="02"){d.PathImg=sap.ui.require.toUrl("application/img/S.png")}else{d.PathImg=sap.ui.require.toUrl("application/img/R.png")}try{var g=d.DatMovto.indexOf("T");if(g>0){g=d.DatMovto.split("T");g=g[0].split("-");var u=g[2]+"/"+g[1]+"/"+g[0]}}catch(t){g=d.DatMovto;if(g!=undefined){n=String(g.getFullYear());l=g.getMonth()+1;l=String(l).length==1?"0"+String(l):String(l);s=g.getDate();s=String(s).length==1?"0"+String(s):String(s);u=s+"/"+l+"/"+n}}d.DatMovto=u;a.push(d)}t.getModel("modelMov").setData(a)}}}},formatTipo:function(t){if(t=="02"){return"Crédito"}else if(t=="01"){return"Débito"}}})});