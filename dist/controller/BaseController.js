sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/core/routing/History","sap/ui/core/UIComponent","sap/m/MessageBox","sap/ui/model/json/JSONModel"],function(e,t,n,r,o){"use strict";return e.extend("application.controller.BaseController",{init:function(){n.prototype.init.apply(this,arguments);this.getRouter().initialize()},getModel:function(e){return this.getView().getModel(e)},setModel:function(e,t){return this.getView().setModel(e,t)},getModelGlobal:function(e){return this.getOwnerComponent().getModel(e)},setModelGlobal:function(e,t){return this.getOwnerComponent().setModel(e,t)},getResourceBundle:function(){return this.getOwnerComponent().getModel("i18n").getResourceBundle()},getRouter:function(){return sap.ui.core.UIComponent.getRouterFor(this)},onNavBack:function(e){var n,r;n=t.getInstance();r=n.getPreviousHash();if(r!==undefined){window.history.go(-1)}else{this.getRouter().navTo("NotFound",{},true)}},formatPeriodo:function(e){if(e!==null&&e!==undefined){return e.substring(0,3)+"/"+e.substring(3,e.length)}},onFormatCnpj:function(e){if(e!=""&&e!==null&&e!=undefined){e=e.replace(/(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})/g,"$1.$2.$3/$4-$5");return e}},onFormatCancelaSaldo:function(e){if(e!=undefined){if(e=="S"){return"Não"}else if(e=="N"){return"Sim"}}},onFormatTelefone:function(e){var t=(""+e).replace(/\D/g,"");var n=t.match(/^(\d{2})(\d{4})(\d{4})$/);if(n){return"("+n[1]+") "+n[2]+"-"+n[3]}return null},myFormatterHora:function(e){if(e!==undefined&&e!==null&&e!==""&&e!==0){var t=e.split(":");return t[0]+":"+t[1]}},myFormatterData:function(e){if(e!==undefined&&e!==null&&e!==""&&e!==0){var t=e.split("/");e=t[0]+"/"+t[1];return e}},onFormatNumberPedido:function(e){for(var t in e){if(t!="Completo"&&t!="CheckIncentivo"&&t!="EnviarEmailCliente"&&t!="EnviarEmailRepres"&&t!="LogVerbaRentNeg"&&t!="TotalItens"&&t!="LogProposta"){e[t]=String(e[t])}if(t=="LogVerbaRentNeg"||t=="LogProposta"){e[t]=String(e[t])=="true"?true:false}}return e},onBuscarPedido:function(e,t,n){var r=this;r.oModel.read("/P_PedidoPR(NrPedido='"+n+"')",{success:function(t){e(t)},error:function(e){t(e)}})},onBuscarItensPedido:function(e,t,n){var r=this;r.oModel.read("/P_ItensPedidoQ",{urlParameters:{$filter:"IvNrPedido eq '"+n+"'"},success:function(t){e(t.results)},error:function(e){t(e)}})},onDeletarItemPedido:function(e,t,n,r){var o=this;o.oModel.remove("/P_ItensPedidoD(IvNrPedido='"+n+"',IvMatnr='"+r+"')",{success:function(t){e("OK")},error:function(e){t(e)}})},onBuscarClientes:function(e,t){var n=this;this.oModel.read("/ClienteQ",{urlParameters:{$filter:"IvUsuario eq '"+this.getModelGlobal("modelAux").getProperty("/CodRepres")+"'"},success:function(t){var r=new o(t.results);n.setModel(r,"Clientes");n.byId("master").setBusy(false);e()},error:function(e){t(e)}})},onFormatNumberItem:function(e){for(var t in e){if(t!="QtdPedida"&&t!="IndexItem"&&t!="ExcIncent"&&t!="ExcVerba"){e[t]=String(e[t])}if(t=="ExcIncent"||t=="ExcVerba"||t=="Draft"){e[t]=String(e[t])=="true"?true:false}}return e},myFormatterDataMobile:function(e){if(e!=undefined){try{var t=e.indexOf("T");if(t>0){t=e.split("T");t=t[0].split("-");return t[2]+"/"+t[1]+"/"+t[0]}}catch(t){var n=e;var r=String(n.getFullYear());var o=n.getMonth()+1;var o=String(o).length==1?"0"+String(o):String(o);var i=n.getDate();var i=String(i).length==1?"0"+String(i+1):String(i+1);return i+"/"+o+"/"+r}}},myFormatterData2:function(e){if(e!==undefined&&e!==null&&e!==""&&e!==0){var t=e.split("/");e=t[0]+"/"+t[1];var t=new Date(Date.UTC(t[2],t[1],t[0]));return t}},onFormatCpf:function(e){if(e!=""&&e!==null&&e!=undefined){e=e.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/g,"$1.$2.$3-$4");return e}},onFormatSimplesNacional:function(e){if(e!=undefined){if(e=="SN"){return"Sim"}else{return"Não"}}},myFormatterDataInvert:function(e){if(e!=undefined){return e.substring(6,8)+"/"+e.substring(4,6)+"/"+e.substring(0,4)}},myFormatterDataRevert:function(e){if(e!=undefined){var t=e.split("/");return[String(t[2])+String(t[1])+String(t[0]),{dia:String(t[0]),mes:String(t[1]),ano:String(t[2])}]}},setaCompleto:function(e,t,n){var r=this;var o=[];var i=e.transaction("PrePedidos","readwrite");var a=i.objectStore("PrePedidos");var s=a.get(n);s.onsuccess=function(r){var i=r.target.result;o=i;o.Completo=t;var a=e.transaction("PrePedidos","readwrite");var s=a.objectStore("PrePedidos");var u=s.put(o);u.onsuccess=function(){console.log("O campo completo foi atualizado para > "+t)};u.onerror=function(){console.log("Erro ao abrir o Pedido > "+n)}}},onCheckOnline:function(e,t,n){var r=this;var o=r.getModelGlobal("modelAux").getData();o.DBModel.read("/CheckOnline(IvUsuario='"+o.CodRepres+"',IvSenha='"+o.Senha+"',IvSistOper='"+o.SistemaOper+"',IvImei='"+o.Imei+"',IvRetirarCheck="+n+",IvVersaoApp='"+o.VersaoApp+"')",{success:function(t){e()},error:function(e){console.log(e);t(e)}})},onDataHora:function(){var e=new Date;var t=String(e.getDate());var n=String(e.getMonth()+1);var r=String(e.getFullYear());var o=String(e.getMinutes());var i=String(e.getHours());var a=String(e.getSeconds());if(t.length==1){t=String("0"+t)}if(n.length==1){n=String("0"+n)}if(o.length==1){o=String("0"+o)}if(i.length==1){i=String("0"+i)}if(a.length==1){a=String("0"+a)}var s={dia:t,mes:n,ano:r,hora:i,min:o,seg:a};var u=String(t+"/"+n+"/"+r);var d=String(i)+":"+String(o)+":"+String(a);return[u,d,s]},onFormatterText:function(e){if(e!=undefined){if(e.length>20){return e.substring(0,20)}else{return e}}},onMensagemErroODATA:function(e){if(e.responseText==undefined){var t=e.response.body;if(t==undefined){var n=e.message}else{var r=new DOMParser;var o=r.parseFromString(t,"text/xml");try{var i=o.getElementsByTagName("message")[0].childNodes[0].nodeValue}catch(e){var i=o.getElementsByTagName("body")[0].childNodes[0].textContent}n=i}}else{try{n=JSON.parse(e.responseText)["error"].message.value}catch(t){var r=new DOMParser;var o=r.parseFromString(e.responseText,"text/xml");try{var i=o.getElementsByTagName("message")[0].childNodes[0].nodeValue}catch(e){var i=o.getElementsByTagName("body")[0].childNodes[0].textContent}n=i}}sap.m.MessageBox.show(n,{icon:sap.m.MessageBox.Icon.WARNING,title:"Erro!",actions:[sap.m.MessageBox.Action.OK],onClose:function(e){}})},onReturnDropTables:function(e){switch(e){case"Login":return["Clientes","Fretes","LocaisEntregas","Produtos","Centros","LeadTime","MsgPedido","PrecoItens","SaldoVerbas","TabPrecos","TipoPedidos","TabelaMovimentacao","ItemExc","Rentabilidade","TitulosAbertos","Vencimentos","DescCanal","DescPromo","DescFlex","Contratos","MotvCamp","TipoIntegraBol","DescCamp","SaldoVerbas","SeqAcessoTab"];case"Reset":return["Clientes","Fretes","LocaisEntregas","Produtos","DescCanal","DescPromo","LeadTime","DescFlex","TabelaMovimentacao","ItemExc","Rentabilidade","Centros","MsgPedido","PrecoItens","SaldoVerbas","TabPrecos","TipoPedidos","Contratos","MotvCamp","TipoIntegraBol","DescCamp","SaldoVerbas","SeqAcessoTab","TitulosAbertos","Vencimentos","ItensPedido","PrePedidos","Aux","Menu"];default:}},setLog:function(e,t){console.log("["+t+"]",e)}})});