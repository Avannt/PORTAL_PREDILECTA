sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/core/routing/History","sap/ui/core/UIComponent","sap/m/MessageBox","sap/ui/model/json/JSONModel","sap/ui/core/format/FileSizeFormat"],function(e,n,t,r,o,i){"use strict";return e.extend("application.controller.BaseController",{init:function(){t.prototype.init.apply(this,arguments);this.getRouter().initialize()},getModel:function(e){return this.getView().getModel(e)},setModel:function(e,n){return this.getView().setModel(e,n)},getModelGlobal:function(e){return this.getOwnerComponent().getModel(e)},setModelGlobal:function(e,n){return this.getOwnerComponent().setModel(e,n)},getResourceBundle:function(){return this.getOwnerComponent().getModel("i18n").getResourceBundle()},getRouter:function(){return sap.ui.core.UIComponent.getRouterFor(this)},onFormatHora:function(e){var n=Math.floor(e%1e3/100),t=Math.floor(e/1e3%60),r=Math.floor(e/(1e3*60)%60),o=Math.floor(e/(1e3*60*60)%24);o=o<10?"0"+o:o;r=r<10?"0"+r:r;t=t<10?"0"+t:t;return o+":"+r+":"+t},onNavBack:function(e){var t,r;t=n.getInstance();r=t.getPreviousHash();if(r!==undefined){window.history.go(-1)}else{this.getRouter().navTo("NotFound",{},true)}},containsSpecialChars:function(e){const n=/[`!@#$%^&*()_+\=\[\]{};':"\\|,<>\?~]/;return n.test(e)},formatAttribute:function(e){if(jQuery.isNumeric(e.ms)){return this.onFormatHora(e.ms)}if(jQuery.isNumeric(e)){return e}else{try{var n=e.getUTCDate();n=String(n).length==1?"0"+String(n):String(n);var t=e.getUTCMonth()+1;t=String(t).length==1?"0"+String(t):String(t);var r=e.getUTCFullYear();return n+"/"+t+"/"+r}catch(n){return e}}},formatPeriodo:function(e){if(e!==null&&e!==undefined){return e.substring(0,3)+"/"+e.substring(3,e.length)}},onFormatCnpj:function(e){if(e!=""&&e!==null&&e!=undefined){e=e.replace(/(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})/g,"$1.$2.$3/$4-$5");return e}},onFormatCancelaSaldo:function(e){if(e!=undefined){if(e=="S"){return"Não"}else if(e=="N"){return"Sim"}}},onFormatTelefone:function(e){var n=(""+e).replace(/\D/g,"");var t=n.match(/^(\d{2})(\d{4})(\d{4})$/);if(t){return"("+t[1]+") "+t[2]+"-"+t[3]}return null},myFormatterHora:function(e){if(e!==undefined&&e!==null&&e!==""&&e!==0){var n=e.split(":");return n[0]+":"+n[1]}},myFormatterData:function(e){if(e!==undefined&&e!==null&&e!==""&&e!==0){var n=e.split("/");e=n[0]+"/"+n[1];return e}},onFormatNumberPedido:function(e){for(var n in e){if(n!="Completo"&&n!="CheckIncentivo"&&n!="EnviarEmailCliente"&&n!="DataIniConv"&&n!="EnviarEmailRepres"&&n!="LogVerbaRentNeg"&&n!="TotalItens"&&n!="LogProposta"){e[n]=String(e[n])}if(n=="PedidoOrigem"){e[n]=e[n].replace(/\s/g,"")}if(n=="LogVerbaRentNeg"||n=="LogProposta"){e[n]=String(e[n])=="true"?true:false}}return e},onBuscarPedidos:function(e,n,t,r,o,i){i.oModel.read("/P_PedidoQ",{urlParameters:{$filter:"IvUsuario eq '"+n+"' and IvKunnr eq '"+e+"' and IvEnvio eq "+t},success:function(e){r(e.results)},error:function(e){o(e)}})},onBuscarProdutos:function(e,n,t,r){r.oModel.read("/Produtos",{urlParameters:{$filter:"IvUsuario eq '"+e+"'"},success:function(e){n(e.results)},error:function(e){t(e)}})},onBuscarTipoPedido:function(e,n,t,r,o,i,a,s){s.oModel.read("/P_TipoPedidosR(IvRepres='"+e+"',IvCliente='"+n+"',IvCentro='"+t+"',IvKvgr4='"+r+"',IvKvgr5='"+o+"')",{success:function(e){i(e)},error:function(e){a(e)}})},onBuscarPedido:function(e,n,t,r){r.oModel.read("/P_PedidoPR(NrPedido='"+e+"')",{success:function(e){n(e)},error:function(e){t(e)}})},onInserirPedido:function(e,n,t,r){r.oModel.create("/P_PedidoPR",e,{method:"POST",success:function(e){n(e)},error:function(e){t(e)}})},onBuscarVencimentos:function(e,n,t){t.oModel.read("/Vencimentos",{success:function(n){e(n.results)},error:function(e){n(e)}})},onBuscarCentros:function(e,n,t,r){r.oModel.read("/Centros",{urlParameters:{$filter:"IvUsuario eq '"+e+"'"},success:function(e){n(e.results)},error:function(e){t(e)}})},onBuscarItensPedido:function(e,n,t){var r=this;r.oModel.read("/P_ItensPedidoQ",{urlParameters:{$filter:"IvNrPedido eq '"+t+"'"},success:function(n){e(n.results)},error:function(e){n(e)}})},onDeletarItemPedido:function(e,n,t,r){var o=this;o.oModel.remove("/P_ItensPedidoD(IvNrPedido='"+t+"',IvMatnr='"+r+"')",{success:function(n){e("OK")},error:function(e){n(e)}})},onBuscarClientes:function(e,n,t,r){r.oModel.read("/ClienteQ",{urlParameters:{$filter:"IvUsuario eq '"+e+"'"},success:function(e){n(e.results)},error:function(e){t(e)}})},onFormatNumberItem:function(e){for(var n in e){if(n!="QtdPedida"&&n!="IndexItem"&&n!="ExcIncent"&&n!="ExcVerba"){e[n]=String(e[n])}if(n=="ExcIncent"||n=="ExcVerba"||n=="Draft"){e[n]=String(e[n])=="true"?true:false}}return e},myFormatterDataMobile:function(e){if(e!=undefined){try{var n=e.indexOf("T");if(n>0){n=e.split("T");n=n[0].split("-");return n[2]+"/"+n[1]+"/"+n[0]}}catch(n){var t=e;var r=String(t.getFullYear());var o=t.getMonth()+1;var o=String(o).length==1?"0"+String(o):String(o);var i=t.getDate();var i=String(i).length==1?"0"+String(i+1):String(i+1);return i+"/"+o+"/"+r}}},myFormatterData2:function(e){if(e!==undefined&&e!==null&&e!==""&&e!==0){var n=e.split("/");e=n[0]+"/"+n[1];var n=new Date(Date.UTC(n[2],n[1],n[0]));return n}},onFormatCpf:function(e){if(e!=""&&e!==null&&e!=undefined){e=e.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/g,"$1.$2.$3-$4");return e}},onFormatSimplesNacional:function(e){if(e!=undefined){if(e=="SN"){return"Sim"}else{return"Não"}}},myFormatterDataInvert:function(e){if(e!=undefined){return e.substring(6,8)+"/"+e.substring(4,6)+"/"+e.substring(0,4)}},myFormatterDataRevert:function(e){if(e!=undefined){var n=e.split("/");return[String(n[2])+String(n[1])+String(n[0]),{dia:String(n[0]),mes:String(n[1]),ano:String(n[2])}]}},onExcluirPed:function(e,n,t){var r=this;r.oModel.remove("/P_PedidoD(IvNrPedido='"+e+"')",{success:function(e){n()},error:function(e){t(e)}})},onCheckOnline:function(e,n,t){var r=this;var o=r.getModelGlobal("modelAux").getData();o.DBModel.read("/CheckOnline(IvUsuario='"+o.CodRepres+"',IvSenha='"+o.Senha+"',IvSistOper='"+o.SistemaOper+"',IvImei='"+o.Imei+"',IvRetirarCheck="+t+",IvVersaoApp='"+o.VersaoApp+"')",{success:function(n){e()},error:function(e){console.log(e);n(e)}})},onDataHora:function(){var e=new Date;var n=String(e.getDate());var t=String(e.getMonth()+1);var r=String(e.getFullYear());var o=String(e.getMinutes());var i=String(e.getHours());var a=String(e.getSeconds());if(n.length==1){n=String("0"+n)}if(t.length==1){t=String("0"+t)}if(o.length==1){o=String("0"+o)}if(i.length==1){i=String("0"+i)}if(a.length==1){a=String("0"+a)}var s={dia:n,mes:t,ano:r,hora:i,min:o,seg:a};var u=String(n+"/"+t+"/"+r);var c=String(i)+":"+String(o)+":"+String(a);return[u,c,s]},onFormatterText:function(e){if(e!=undefined){if(e.length>20){return e.substring(0,20)}else{return e}}},onMensagemErroODATA:function(e){if(e.responseText==undefined){if(e.response==undefined){t=String(e)}else{var n=e.response.body;if(n==undefined){var t=e.message}else{var r=new DOMParser;var o=r.parseFromString(n,"text/xml");try{var i=o.getElementsByTagName("message")[0].childNodes[0].nodeValue}catch(e){var i=o.getElementsByTagName("body")[0].childNodes[0].textContent}t=i}}}else{try{t=JSON.parse(e.responseText)["error"].message.value}catch(n){var r=new DOMParser;var o=r.parseFromString(e.responseText,"text/xml");try{var i=o.getElementsByTagName("message")[0].childNodes[0].nodeValue}catch(e){var i=o.getElementsByTagName("body")[0].childNodes[0].textContent}t=i}}sap.m.MessageBox.show(t,{icon:sap.m.MessageBox.Icon.WARNING,title:"Erro!",actions:[sap.m.MessageBox.Action.OK],onClose:function(e){}})},onDialogCancelar:function(){if(this._ItemDialog){this._ItemDialog.destroy(true)}},setLog:function(e,n){console.log("["+n+"]",e)}})});